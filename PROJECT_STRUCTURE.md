# ğŸ“ Project Structure - Momentum App

Complete overview of the Momentum task management app architecture and file organization.

---

## ğŸ›ï¸ Architecture Overview

This project follows **Clean Architecture** principles with three distinct layers:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer              â”‚
â”‚   (UI, Widgets, BLoC, Themes)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Domain Layer                   â”‚
â”‚   (Entities, Use Cases, Interfaces)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Data Layer                    â”‚
â”‚   (Models, Repositories, Data Sources)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dependency Rule
- **Domain** layer is independent (no external dependencies)
- **Data** layer depends on **Domain**
- **Presentation** layer depends on **Domain**
- Data flows: UI â†’ BLoC â†’ Use Case â†’ Repository â†’ Data Source â†’ Database

---

## ğŸ“‚ Complete Directory Structure

```
Momentum/momentum/
â”‚
â”œâ”€â”€ lib/                                # Main source code
â”‚   â”œâ”€â”€ core/                          # Core utilities and configuration
â”‚   â”‚   â””â”€â”€ di.dart                    # Dependency Injection container
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                          # Data Layer - External data handling
â”‚   â”‚   â”œâ”€â”€ datasources/               # Data source implementations
â”‚   â”‚   â”‚   â””â”€â”€ task_local_data_source.dart
â”‚   â”‚   â”œâ”€â”€ models/                    # Data models (Isar schemas)
â”‚   â”‚   â”‚   â”œâ”€â”€ task_model.dart
â”‚   â”‚   â”‚   â””â”€â”€ task_model.g.dart      # Generated by build_runner
â”‚   â”‚   â”œâ”€â”€ repositories/              # Repository implementations
â”‚   â”‚   â”‚   â””â”€â”€ task_repository_impl.dart
â”‚   â”‚   â””â”€â”€ services/                  # External services
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                        # Domain Layer - Business logic
â”‚   â”‚   â”œâ”€â”€ entities/                  # Business entities
â”‚   â”‚   â”‚   â””â”€â”€ task.dart
â”‚   â”‚   â”œâ”€â”€ repositories/              # Repository interfaces
â”‚   â”‚   â”‚   â””â”€â”€ task_repository.dart
â”‚   â”‚   â””â”€â”€ usecases/                  # Business use cases
â”‚   â”‚       â”œâ”€â”€ create_task_use_case.dart
â”‚   â”‚       â”œâ”€â”€ delete_task_use_case.dart
â”‚   â”‚       â”œâ”€â”€ get_all_tasks_use_case.dart
â”‚   â”‚       â””â”€â”€ update_task_use_case.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ presentation/                  # Presentation Layer - UI
â”‚   â”‚   â”œâ”€â”€ blocs/                     # State management (BLoC)
â”‚   â”‚   â”‚   â”œâ”€â”€ task_bloc.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ task_event.dart
â”‚   â”‚   â”‚   â””â”€â”€ task_state.dart
â”‚   â”‚   â”œâ”€â”€ screens/                   # Full-screen pages
â”‚   â”‚   â”‚   â”œâ”€â”€ create_task_page.dart
â”‚   â”‚   â”‚   â””â”€â”€ home_page.dart
â”‚   â”‚   â”œâ”€â”€ themes/                    # App theming
â”‚   â”‚   â”‚   â”œâ”€â”€ dark_theme.dart
â”‚   â”‚   â”‚   â””â”€â”€ light_theme.dart
â”‚   â”‚   â”œâ”€â”€ utils/                     # UI utilities
â”‚   â”‚   â””â”€â”€ widgets/                   # Reusable widgets
â”‚   â”‚       â””â”€â”€ task_card.dart
â”‚   â”‚
â”‚   â””â”€â”€ main.dart                      # App entry point
â”‚
â”œâ”€â”€ assets/                            # Static assets
â”‚   â””â”€â”€ translations/                  # Localization files
â”‚       â”œâ”€â”€ en.json                    # English translations
â”‚       â””â”€â”€ ru.json                    # Russian translations
â”‚
â”œâ”€â”€ test/                              # Test files
â”‚   â””â”€â”€ widget_test.dart
â”‚
â”œâ”€â”€ android/                           # Android-specific files
â”œâ”€â”€ ios/                              # iOS-specific files
â”œâ”€â”€ linux/                            # Linux-specific files
â”œâ”€â”€ macos/                            # macOS-specific files
â”œâ”€â”€ windows/                          # Windows-specific files
â”œâ”€â”€ web/                              # Web-specific files
â”‚
â”œâ”€â”€ pubspec.yaml                       # Dependencies and assets
â”œâ”€â”€ pubspec.lock                       # Locked dependency versions
â”œâ”€â”€ analysis_options.yaml              # Linter configuration
â”œâ”€â”€ README.md                          # Project documentation
â”œâ”€â”€ QUICKSTART.md                      # Quick start guide
â””â”€â”€ PROJECT_STRUCTURE.md               # This file
```

---

## ğŸ“„ File Descriptions

### Core Layer (`lib/core/`)

#### `di.dart` - Dependency Injection
- **Purpose:** Manages all app dependencies
- **Functions:**
  - Initializes Isar database
  - Creates data sources, repositories, use cases
  - Provides BLoC instances
- **Pattern:** Service Locator
- **Usage:** Called in `main.dart` before app starts

---

### Domain Layer (`lib/domain/`)

This layer contains **pure business logic** with no external dependencies.

#### `entities/task.dart`
- **Purpose:** Core business entity representing a task
- **Contains:**
  - Task properties (id, title, description, etc.)
  - TaskPriority enum (low, medium, high, urgent)
  - Business methods (copyWith)
- **Note:** Uses Equatable for value comparison

#### `repositories/task_repository.dart`
- **Purpose:** Interface defining task data operations
- **Contains:** Abstract methods for CRUD operations
- **Implementation:** In data layer (task_repository_impl.dart)

#### `usecases/`
Each use case encapsulates a single business operation:

- **`create_task_use_case.dart`** - Create new task with validation
- **`update_task_use_case.dart`** - Update existing task with validation
- **`delete_task_use_case.dart`** - Delete task by ID
- **`get_all_tasks_use_case.dart`** - Retrieve all tasks

**Pattern:** Each use case has a `call()` method that executes the operation.

---

### Data Layer (`lib/data/`)

This layer handles all data persistence and external data sources.

#### `datasources/task_local_data_source.dart`
- **Purpose:** Direct interface with Isar database
- **Operations:**
  - CRUD operations
  - Filtering (by date, priority, category)
  - Search functionality
  - Sorting and querying
- **Technology:** Isar NoSQL database

#### `models/task_model.dart`
- **Purpose:** Isar database schema definition
- **Annotations:** 
  - `@collection` - Marks as Isar collection
  - `@Index()` - Creates database index
  - `@Enumerated()` - Enum storage strategy
- **Methods:**
  - `toEntity()` - Converts to domain entity
  - `fromEntity()` - Creates from domain entity
- **Note:** Generates `task_model.g.dart` via build_runner

#### `repositories/task_repository_impl.dart`
- **Purpose:** Implements domain repository interface
- **Role:** Bridges domain and data layers
- **Converts:** Between domain entities and data models
- **Error Handling:** Wraps exceptions with meaningful messages

---

### Presentation Layer (`lib/presentation/`)

This layer contains all UI components and state management.

#### `blocs/task_bloc.dart`
- **Purpose:** Manages task-related state
- **Pattern:** BLoC (Business Logic Component)
- **Contains:**
  - Event handlers for all task operations
  - State emission logic
  - Interaction with use cases
- **Events Handled:**
  - Load, create, update, delete tasks
  - Filter, search, toggle completion
  - Batch operations

#### `blocs/task_event.dart`
- **Purpose:** Defines all possible task events
- **Events Include:**
  - LoadTasksEvent
  - CreateTaskEvent
  - UpdateTaskEvent
  - DeleteTaskEvent
  - ToggleTaskCompletionEvent
  - Filter events (by priority, category, date)
- **Pattern:** Immutable event classes using Equatable

#### `blocs/task_state.dart`
- **Purpose:** Defines all possible task states
- **States Include:**
  - TaskInitial - Before loading
  - TaskLoading - Loading in progress
  - TaskLoaded - Successfully loaded
  - TaskEmpty - No tasks found
  - TaskError - Error occurred
  - TaskOperationInProgress - Operation in progress
  - TaskOperationSuccess - Operation completed
- **Pattern:** Immutable state classes using Equatable

#### `screens/home_page.dart`
- **Purpose:** Main screen displaying task list
- **Features:**
  - Task list with filtering
  - Statistics dashboard
  - Empty state handling
  - Error state handling
  - Navigation to create/edit
- **BLoC Integration:** Uses BlocConsumer for state management

#### `screens/create_task_page.dart`
- **Purpose:** Create and edit tasks
- **Features:**
  - Form validation
  - Date/time pickers
  - Priority selection
  - Quick date presets
  - Edit mode support
- **Modes:** Create new or edit existing task

#### `widgets/task_card.dart`
- **Purpose:** Reusable task display component
- **Features:**
  - Checkbox for completion
  - Title and description
  - Due date with color coding
  - Priority indicator
  - Category badge
  - Delete button
  - Overdue highlighting
- **Actions:** Tap to edit, toggle completion, delete

#### `themes/light_theme.dart` & `dark_theme.dart`
- **Purpose:** Material 3 theme definitions
- **Contains:**
  - Color schemes
  - Component themes
  - Typography
  - Spacing and sizing
- **Support:** Automatic system theme switching

---

## ğŸ”„ Data Flow Examples

### Creating a Task

```
1. User taps "New Task" button
   â†“
2. CreateTaskPage displays form
   â†“
3. User fills form and taps "Save"
   â†“
4. CreateTaskEvent is dispatched to TaskBloc
   â†“
5. TaskBloc calls CreateTaskUseCase
   â†“
6. Use case validates data
   â†“
7. Use case calls TaskRepository.createTask()
   â†“
8. Repository converts entity to model
   â†“
9. Repository calls TaskLocalDataSource.createTask()
   â†“
10. Data source saves to Isar database
    â†“
11. Success bubbles back up
    â†“
12. TaskBloc emits TaskOperationSuccess state
    â†“
13. UI displays success message and updates list
```

### Loading Tasks

```
1. HomePage initiates
   â†“
2. LoadTasksEvent dispatched to TaskBloc
   â†“
3. TaskBloc emits TaskLoading state
   â†“
4. TaskBloc calls GetAllTasksUseCase
   â†“
5. Use case calls TaskRepository.getAllTasks()
   â†“
6. Repository calls TaskLocalDataSource.getAllTasks()
   â†“
7. Data source queries Isar database
   â†“
8. Models converted to entities
   â†“
9. TaskBloc emits TaskLoaded state with data
   â†“
10. UI rebuilds with task list
```

---

## ğŸ¯ Key Concepts

### 1. Clean Architecture Benefits
- **Testability:** Each layer can be tested independently
- **Maintainability:** Changes isolated to specific layers
- **Scalability:** Easy to add features
- **Independence:** Business logic separated from frameworks

### 2. BLoC Pattern
- **Separation:** UI and business logic completely separated
- **Reactive:** UI reacts to state changes
- **Testable:** Easy to test state changes
- **Predictable:** Clear state transitions

### 3. Repository Pattern
- **Abstraction:** Domain doesn't know about data sources
- **Flexibility:** Easy to swap data sources (local/remote)
- **Single Responsibility:** Each repository handles one entity

### 4. Use Case Pattern
- **Single Responsibility:** One use case = one business operation
- **Reusability:** Use cases can be composed
- **Testability:** Easy to test business rules

---

## ğŸ”§ Development Guidelines

### Adding a New Feature

1. **Domain Layer:**
   - Create entity if needed
   - Add repository method to interface
   - Create use case

2. **Data Layer:**
   - Update model if needed
   - Add data source method
   - Implement repository method

3. **Presentation Layer:**
   - Add BLoC events
   - Add BLoC states
   - Implement event handler
   - Create/update UI

### File Naming Conventions

- **Entities:** `entity_name.dart` (e.g., `task.dart`)
- **Models:** `entity_name_model.dart` (e.g., `task_model.dart`)
- **Repositories:** `entity_name_repository.dart`
- **Use Cases:** `action_entity_use_case.dart` (e.g., `create_task_use_case.dart`)
- **BLoCs:** `entity_name_bloc.dart`, `entity_name_event.dart`, `entity_name_state.dart`
- **Screens:** `screen_name_page.dart` (e.g., `home_page.dart`)
- **Widgets:** `widget_name.dart` (e.g., `task_card.dart`)

### Code Style

- Use meaningful variable names
- Add documentation comments
- Follow Dart style guide
- Keep files under 500 lines
- Extract complex logic to separate methods

---

## ğŸ“š Dependencies Overview

### Production Dependencies

| Package | Purpose | Layer |
|---------|---------|-------|
| flutter_bloc | State management | Presentation |
| isar | Local database | Data |
| dio | HTTP client | Data (future) |
| equatable | Value equality | All |
| intl | Date formatting | Presentation |
| path_provider | File paths | Data |
| shared_preferences | Simple storage | Data |

### Development Dependencies

| Package | Purpose |
|---------|---------|
| build_runner | Code generation |
| isar_generator | Isar schema generation |
| flutter_lints | Code quality |

---

## ğŸ§ª Testing Strategy

### Unit Tests
- **Domain Layer:** Test use cases and entity methods
- **Data Layer:** Test repository implementations
- **Presentation Layer:** Test BLoC logic

### Widget Tests
- Test individual widgets
- Test screen layouts
- Test user interactions

### Integration Tests
- Test complete user flows
- Test data persistence
- Test navigation

---

## ğŸš€ Build & Deploy

### Development Build
```bash
flutter run
```

### Production Build
```bash
# Android
flutter build apk --release

# iOS
flutter build ios --release

# Desktop
flutter build macos --release
```

---

## ğŸ“ Notes

- Always run `build_runner` after modifying Isar models
- Keep business logic in domain layer
- Use BLoC for all state management
- Follow the dependency rule strictly
- Document complex business logic
- Write tests for critical paths

---

**Last Updated:** 2024
**Version:** 1.0.0
**Architecture:** Clean Architecture + BLoC + Isar